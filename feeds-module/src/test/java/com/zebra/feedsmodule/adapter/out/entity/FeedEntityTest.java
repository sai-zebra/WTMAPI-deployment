package com.zebra.feedsmodule.adapter.out.entity;


import org.junit.jupiter.api.DisplayName;
import org.junit.jupiter.api.Test;

import java.time.OffsetDateTime;
import java.util.ArrayList;
import java.util.List;
import java.util.UUID;

import static org.assertj.core.api.Assertions.assertThat;


//  Unit tests for the FeedEntity.
//  This class primarily tests the getters, setters, and constructors generated by Lombok
//  to ensure they behave as expected and kill related PITest mutations, especially for
//  createdAt and feedNotes fields.

class FeedEntityTest {

    private final UUID id = UUID.randomUUID();
    private final String title = "Test Feed Title";
    private final String message = "This is a test message.";
    private final String status = "ACTIVE";
    private final OffsetDateTime createdAt = OffsetDateTime.now();
    private final List<FeedNoteEntity> feedNotes = new ArrayList<>();

    @Test
    @DisplayName("NoArgsConstructor should create an empty FeedEntity")
    void noArgsConstructor_shouldCreateEmptyEntity() {
        FeedEntity feed = new FeedEntity();
        assertThat(feed).isNotNull();
        assertThat(feed.getId()).isNull();
        assertThat(feed.getTitle()).isNull();
        assertThat(feed.getMessage()).isNull();
        assertThat(feed.getStatus()).isNull();
        assertThat(feed.getCreatedAt()).isNull();
        assertThat(feed.getFeedNotes()).isNull(); // Lombok's default for List is null
    }

    @Test
    @DisplayName("AllArgsConstructor should create FeedEntity with all provided values")
    void allArgsConstructor_shouldCreateEntityWithAllValues() {
        // Given
        feedNotes.add(new FeedNoteEntity()); // Add a dummy note for the list

        // When
        FeedEntity feed = new FeedEntity(id, title, message, status, createdAt, feedNotes);

        // Then
        assertThat(feed).isNotNull();
        assertThat(feed.getId()).isEqualTo(id);
        assertThat(feed.getTitle()).isEqualTo(title);
        assertThat(feed.getMessage()).isEqualTo(message);
        assertThat(feed.getStatus()).isEqualTo(status);
        assertThat(feed.getCreatedAt()).isEqualTo(createdAt); // Kills createdAt=null mutant
        assertThat(feed.getFeedNotes()).isEqualTo(feedNotes); // Kills feedNotes=emptyList mutant
        assertThat(feed.getFeedNotes()).hasSize(1);
    }

    @Test
    @DisplayName("Setters and Getters should work correctly for all fields")
    void settersAndGetters_shouldWorkCorrectly() {
        // Given
        FeedEntity feed = new FeedEntity();
        UUID newId = UUID.randomUUID();
        String newTitle = "Updated Title";
        String newMessage = "Updated Message";
        String newStatus = "COMPLETED";
        OffsetDateTime newCreatedAt = OffsetDateTime.now().minusDays(1);
        List<FeedNoteEntity> newFeedNotes = List.of(new FeedNoteEntity());

        // When
        feed.setId(newId);
        feed.setTitle(newTitle);
        feed.setMessage(newMessage);
        feed.setStatus(newStatus);
        feed.setCreatedAt(newCreatedAt);
        feed.setFeedNotes(newFeedNotes);

        // Then
        assertThat(feed.getId()).isEqualTo(newId);
        assertThat(feed.getTitle()).isEqualTo(newTitle);
        assertThat(feed.getMessage()).isEqualTo(newMessage);
        assertThat(feed.getStatus()).isEqualTo(newStatus);
        assertThat(feed.getCreatedAt()).isEqualTo(newCreatedAt); // Kills createdAt=null mutant
        assertThat(feed.getFeedNotes()).isEqualTo(newFeedNotes); // Kills feedNotes=emptyList mutant
        assertThat(feed.getFeedNotes()).hasSize(1);
    }
}
